// Function to handle 2FA code verification
function verify2FACode() {
    var user2FACode = document.getElementById("2faCode").value;

    if (user2FACode === twoFACode.toString()) { // Compare the input code with the 2FA code
        alert("Congrats, you have been verified!");

        // Validate reCAPTCHA response
        var recaptchaResponse = grecaptcha.getResponse();
        if (!recaptchaResponse) {
            alert("Please complete the reCAPTCHA verification.");
            return;  // Do not proceed if reCAPTCHA is not completed
        }

        // Send the reCAPTCHA response and other data to an external service (e.g., serverless function)
        fetch('https://example.com/verify-recaptcha', {  // Use your serverless function URL
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                recaptchaResponse: recaptchaResponse,
                studentID: studentID,
                twoFACode: twoFACode
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                window.location.href = "https://jamesaai.netlify.app";  // Redirect to the desired URL
            } else {
                alert("Verification failed. Please try again.");
            }
        })
        .catch(error => {
            console.error("Error during verification:", error);
            alert("There was an error during verification. Please try again.");
        });
    } else {
        alert("Incorrect 2FA code. Please try again.");
    }
}
